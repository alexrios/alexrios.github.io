<!DOCTYPE html><html lang="en" class="dark"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/icon.png"><meta name="generator" content="Astro v5.5.2"><!-- Font preloads --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://alexrios.me/blog/zig-build-cache/"><!-- Primary Meta Tags --><title>The build cache of Zig | alexrios</title><meta name="title" content="The build cache of Zig"><meta name="description" content="A masterclass in not doing stupid things again and again..."><meta name="author" content="Alex Rios"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://alexrios.me/blog/zig-build-cache/"><meta property="og:title" content="The build cache of Zig"><meta property="og:description" content="A masterclass in not doing stupid things again and again..."><meta property="og:image" content="https://alexrios.me/og-image/zig-build-cache.png"><meta property="article:author" content="Alex Rios"><meta property="article:published_time" content="2025-06-30T03:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://alexrios.me/blog/zig-build-cache/"><meta property="twitter:title" content="The build cache of Zig"><meta property="twitter:description" content="A masterclass in not doing stupid things again and again..."><meta property="twitter:image" content="https://alexrios.me/og-image/zig-build-cache.png"><link rel="stylesheet" href="/_astro/about.mLUw1Hba.css">
<link rel="stylesheet" href="/_astro/about.CxWkPOEW.css">
<style>li[data-astro-cid-zekvapgs]:before{content:"#";margin-right:-.5rem;color:var(--theme-accent)}.active-toc[data-astro-cid-zekvapgs]{color:var(--theme-accent)}button[data-astro-cid-xuhzuiaq]{position:fixed;bottom:1rem;left:82%;display:none;height:3rem;width:3rem;align-items:center;justify-content:center;border-radius:9999px;background-color:var(--theme-accent);color:var(--theme-bg);--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}button[data-astro-cid-xuhzuiaq]:hover{--tw-scale-x: 1.25;--tw-scale-y: 1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}@media (min-width: 640px){button[data-astro-cid-xuhzuiaq]{bottom:2rem;height:2.5rem;width:2.5rem}}@media (min-width: 768px){button[data-astro-cid-xuhzuiaq]{left:90%}}@media (min-width: 1536px){button[data-astro-cid-xuhzuiaq]{left:75%}}
</style></head> <body> <header class="group relative mb-8 flex justify-between items-center gap-4" id="main-header" data-astro-cid-3ef6ksr2> <div class="block" data-astro-cid-3ef6ksr2> <a class="title whitespace-nowrap" href="/" aria-current="false" data-astro-cid-3ef6ksr2>alexrios</a> </div> <nav class="mt-4 bg-surface/95 sm:bg-bgColor absolute hidden top-8 w-full sm:block sm:static sm:mt-0 group-[.menu-open]:z-50 group-[.menu-open]:flex group-[.menu-open]:bg-bgColor" id="navigation-menu" aria-label="main menu" data-astro-cid-3ef6ksr2> <div class="space-y-1 px-2 pb-3 pt-2 sm:flex sm:px-0 sm:py-0 sm:space-y-0 sm:space-x-2" data-astro-cid-3ef6ksr2> <a href="/" class="block py-2 sm:py-0" title="Home" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a> <a href="/about" class="block py-2 sm:py-0" title="About" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> About </a> <a href="/blog" class="block py-2 sm:py-0" title="Blog" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a> <a href="/books" class="block py-2 sm:py-0" title="Books" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Books </a> <a href="/speaker" class="block py-2 sm:py-0" title="Speaker" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Speaker </a> <a href="/archive" class="block py-2 sm:py-0" title="Archive" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Archive </a>  <a href="/tags" class="sm:hidden block py-2 sm:py-0" title="tags" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Tags </a>  <a href="/series" class="sm:hidden block py-2 sm:py-0" title="series" aria-current="false" data-astro-prefetch="true" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Series </a>  </div> </nav> <div class="flex gap-2 items-center justify-center" data-astro-cid-3ef6ksr2> <button id="themeToggle" class="transition-all relative" aria-label="toggle theme" data-astro-cid-x3pjskd3> <svg width="25px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-astro-cid-x3pjskd3> <path class="sun opacity-100 transition-all dark:scale-0 dark:opacity-0" fill-rule="evenodd" d="M12 17.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zm0 1.5a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm12-7a.8.8 0 0 1-.8.8h-2.4a.8.8 0 0 1 0-1.6h2.4a.8.8 0 0 1 .8.8zM4 12a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1 0-1.6h2.5a.8.8 0 0 1 .8.8zm16.5-8.5a.8.8 0 0 1 0 1l-1.8 1.8a.8.8 0 0 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM6.3 17.7a.8.8 0 0 1 0 1l-1.7 1.8a.8.8 0 1 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM12 0a.8.8 0 0 1 .8.8v2.5a.8.8 0 0 1-1.6 0V.8A.8.8 0 0 1 12 0zm0 20a.8.8 0 0 1 .8.8v2.4a.8.8 0 0 1-1.6 0v-2.4a.8.8 0 0 1 .8-.8zM3.5 3.5a.8.8 0 0 1 1 0l1.8 1.8a.8.8 0 1 1-1 1L3.5 4.6a.8.8 0 0 1 0-1zm14.2 14.2a.8.8 0 0 1 1 0l1.8 1.7a.8.8 0 0 1-1 1l-1.8-1.7a.8.8 0 0 1 0-1z" data-astro-cid-x3pjskd3></path> <path class="moon opacity-0 transition-all dark:scale-100 dark:opacity-100" fill-rule="evenodd" d="M16.5 6A10.5 10.5 0 0 1 4.7 16.4 8.5 8.5 0 1 0 16.4 4.7l.1 1.3zm-1.7-2a9 9 0 0 1 .2 2 9 9 0 0 1-11 8.8 9.4 9.4 0 0 1-.8-.3c-.4 0-.8.3-.7.7a10 10 0 0 0 .3.8 10 10 0 0 0 9.2 6 10 10 0 0 0 4-19.2 9.7 9.7 0 0 0-.9-.3c-.3-.1-.7.3-.6.7a9 9 0 0 1 .3.8z" data-astro-cid-x3pjskd3></path> </svg> </button>  <script>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
      return 'light';
  })();

  if (theme === 'light') {
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  }

  document.getElementById("themeToggle").addEventListener("click", handleToggleClick);
</script> <nav-button data-astro-cid-3ef6ksr2="true"> <div class="sm:hidden" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>open main menu</span> <button class="group flex items-center justify-center" type="button" id="navigation-menu-btn" aria-label="Open main menu" aria-expanded="false" aria-haspopup="menu" data-astro-cid-3ef6ksr2> <!-- icon when menu is closed --> <svg class="transform transition-all duration-150 ease-out group-aria-expanded:scale-0 group-aria-expanded:opacity-0 h-6 w-6 block group-aria-expanded:hidden" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" data-astro-cid-3ef6ksr2></path> </svg> <!-- icon when menu is open --> <svg class="transform transition-all duration-150 ease-out h-6 w-6 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100 hidden group-aria-expanded:block" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-astro-cid-3ef6ksr2> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" data-astro-cid-3ef6ksr2></path> </svg> </button> </div> </nav-button> </div> </header>  <script type="module">class e extends HTMLElement{headerEl;mobileButtonEl;menuOpen;constructor(){super(),this.headerEl=document.getElementById("main-header"),this.mobileButtonEl=this.querySelector("button"),this.menuOpen=!1,this.mobileButtonEl.addEventListener("click",this.toggleMobileMenu)}toggleMobileMenu=()=>{this.headerEl.classList.toggle("menu-open"),this.menuOpen=!this.menuOpen,this.mobileButtonEl.setAttribute("aria-expanded",this.menuOpen.toString())}}customElements.define("nav-button",e);</script> <main class="grid grid-cols-1 gap-y-16 sm:grid-cols-[3fr_1fr] sm:gap-x-4">  <article class="cody-bg prose dark:prose-invert prose-cody text-textColor max-w-4xl"> <header class="space-y-2"> <div class="aspect-h-9 aspect-w-16 mb-6 w-full flex justify-center"> <img src="/troops.png" alt="Never forget your past" class="m-0"> </div>  <div class="flex gap-2 items-center"> <h1 class="text-3xl my-0">The build cache of Zig</h1>  </div> <span class="font-semibold text-textColor flex gap-2 items-center"> <time datetime="2025-06-30T03:00:00.000Z" title="30 June 2025"> 30 June 2025 </time> <span>
/ 8 min read </span>  </span> <ul class="not-prose flex gap-2 flex-wrap"> <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false" class="w-5 h-5" astro-icon="carbon:tag-group"><circle cx="10" cy="14" r="2" fill="currentColor"/><path fill="currentColor" d="M16 30a1 1 0 0 1-.71-.29L4.59 19A2 2 0 0 1 4 17.59V10a2 2 0 0 1 2-2h7.59a2 2 0 0 1 1.41.59l10.71 10.7a1 1 0 0 1 0 1.42l-9 9A1 1 0 0 1 16 30zM6 10v7.59l10 10L23.59 20l-10-10z"/><path fill="currentColor" d="M27.71 13.29 17 2.59A2 2 0 0 0 15.59 2H8a2 2 0 0 0-2 2v2h2V4h7.59l10 10-1.3 1.29 1.42 1.42 2-2a1 1 0 0 0 0-1.42z"/></svg> <li class="tag"> <a href="/tags/zig">zig</a> </li><li class="tag"> <a href="/tags/build">build</a> </li> </ul> </header> <hr class="my-4"> <main class="prose-sm prose-headings:font-semibold prose-headings:ml-4 prose-headings:before:absolute prose-headings:before:-ms-4 prose-headings:before:text-accent prose-headings:before:content-['#'] prose-th:before:content-none prose-a:text-accent">  <p>I’ve been around long enough to watch countless build systems stumble through the same mistakes, like drunk tourists trying to find their hotel at 3 AM in a foreign city. Most of them treat caching as an afterthought-a band-aid slapped on after someone complains that their 15-second “Hello World” build is getting in the way of their coffee breaks. So when I encountered Zig’s approach to building caching, I had to pause and appreciate what happens when someone actually thinks before they code.</p>
<h2 id="determinism-isnt-optional">Determinism isn’t optional</h2>
<p>Zig takes a refreshingly boring approach: everything is deterministic. Non-debug builds produce bit-for-bit identical outputs every single time. This isn’t just neat; it’s the foundation that makes their caching system actually work, rather than being a glorified random number generator with a filesystem interface.</p>
<h1 id="core-architecture-content-addressable-storage-done-right">Core architecture: Content-Addressable Storage done right</h1>
<p>Let’s talk about what lives in that <code>.zig-cache</code> directory that mysteriously appears when you build something. Unlike certain build systems that shall remain nameless (but rhyme with “make”), Zig <a href="https://apenwarr.ca/log/20181113">doesn’t use timestamps</a> to figure out what needs rebuilding. Time, as it turns out, is a terrible way to track changes (who would have thought?). Instead, Zig uses content-addressable storage with SHA-256 hashes.
The cache is organized into several directories:</p>
<ul>
<li><a href="(https://github.com/ziglang/zig/blob/master/lib/compiler/build_runner.zig#L71C1-L74C11)"><code>h/</code></a> - Contains manifest files that track compilation inputs</li>
<li><a href="https://github.com/ziglang/zig/blob/master/src/Compilation.zig#L2207"><code>o/</code></a> - Stores the actual build artifacts (object files, executables)</li>
<li><a href="https://github.com/ziglang/zig/blob/master/src/Compilation.zig#L1954"><code>z/</code></a> - Houses cached ZIR (Zig Intermediate Representation) code</li>
<li><a href="https://github.com/ziglang/zig/blob/master/src/Compilation.zig#L2618"><code>tmp/</code></a> - Temporary files that graduate to o/ once they’re complete</li>
</ul>
<p>For example:</p>
<pre class="astro-code astro-code-themes catppuccin-mocha catppuccin-latte" style="background-color:#1e1e2e;--shiki-dark-bg:#eff1f5;color:#cdd6f4;--shiki-dark:#4c4f69; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">tree</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> .zig-cache/</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">.zig-cache/</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> h</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 60e55db167264eb735bedda2467a689d.txt</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 80121fe227a78e62803e495033e52637.txt</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> d14841a1dc6303f8748fd937df76ed37.txt</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> f4d35e0ea8f7de439959d1c0e429347f.txt</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> timestamp</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> o</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 28c6e1338853cd33836e2fa9eedf4cf0</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 28ca418eac82159e4eba83496bb257ed</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> dependencies.zig</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 3f84ad9eb751d9461a857ae44c635099</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> cimport.h</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> cimport.h.d</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 54797608fb962c4d748fc1f17785ec83</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> build</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> build.o</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 6ab5aaf3922afb9c9f3aae2333a57e47</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> build</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> build.o</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 90cae17f026c5f5245bbea81a38425fc</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> dependencies.zig</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> d33128366193bf0be24f65bab1a00db4</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> │  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> cimport.zig</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> e8fd1b162ffef559e2d5327a4bfc69c9</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B">     ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> fg</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">│  </span><span style="color:#A6E3A1;--shiki-dark:#40A02B">     └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> fg.o</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> tmp</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">└──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> z</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 16cf57812aebb5ebe47e3987b71b9d76</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 229f88f84a8ebd6b28eb674b979f759b</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 39a1f81490069b92bb93b934f2e923da</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 4a9d07acf0cf42aa6f0fa1e03586ea4a</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 83373531c8c15cd1a99138d467771baa</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> 8cdfae77859ae8fcae466014efb9871c</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> c8114b040daa461a9e2eabd0357554a4</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    ├──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> e25bfbaf103595d4c63bb75f12c8fec7</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    └──</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> f584d7a82e773a8ccab74d110e816abc</span></span></code></pre>
<p>The manifest files in the <code>h/</code> directory are <strong>particularly clever</strong>. They don’t just track file contents; <a href="https://gist.github.com/alexrios/091b268cfc1376257a67f9ee94c2cb6a">they track everything that could affect the build, including compiler options, target architecture, ABI settings, and even the Zig library directory path</a>. It’s like having a paranoid accountant who documents every penny, except this accountant prevents builds from breaking in mysterious ways.</p>
<h2 id="the-build-process">The Build Process</h2>
<p>Here’s where things get interesting. When you run <code>zig build</code>, <strong>you’re not directly invoking the compiler</strong>. Instead, Zig compiles your <code>build.zig</code> file into a build runner executable, caches it (naturally), and then executes it.
This build runner then orchestrates the actual compilation.</p>
<h3 id="stage-1-build-runner-compilation">Stage 1: Build runner compilation</h3>
<p>The <a href="https://github.com/ziglang/zig/blob/master/lib/compiler/build_runner.zig"><code>build_runner.zig</code></a> is the build runner that gets compiled. If we look at the very top of the file:</p>
<pre class="astro-code astro-code-themes catppuccin-mocha catppuccin-latte" style="background-color:#1e1e2e;--shiki-dark-bg:#eff1f5;color:#cdd6f4;--shiki-dark:#4c4f69; overflow-x: auto;" tabindex="0" data-language="zig"><code><span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">pub</span><span style="color:#CBA6F7;--shiki-dark:#8839EF"> const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> root </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#F38BA8;font-style:italic;--shiki-dark:#D20F39;--shiki-dark-font-style:italic"> @import</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"@build"</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">pub</span><span style="color:#CBA6F7;--shiki-dark:#8839EF"> const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> dependencies </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#F38BA8;font-style:italic;--shiki-dark:#D20F39;--shiki-dark-font-style:italic"> @import</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"@dependencies"</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span></code></pre>
<p>These special imports (<code>@build</code> and <code>@dependencies</code>) are not regular files. They are generated by the Zig compiler to include YOUR build.zig file.</p>
<h3 id="stage-2-running-your-build">Stage 2: Running your build</h3>
<p>In the <code>main()</code> function of <code>build_runner.zig</code>, you can see it calls your build function:</p>
<pre class="astro-code astro-code-themes catppuccin-mocha catppuccin-latte" style="background-color:#1e1e2e;--shiki-dark-bg:#eff1f5;color:#cdd6f4;--shiki-dark:#4c4f69; overflow-x: auto;" tabindex="0" data-language="zig"><code><span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> builder </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#CBA6F7;--shiki-dark:#8839EF"> try</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> std</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">Build</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">create</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span></span>
<span class="line"><span style="color:#94E2D5;--shiki-dark:#179299">    &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">graph</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">    build_root_directory</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">    local_cache_directory</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">    dependencies</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">root_deps</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7086;font-style:italic;--shiki-dark:#9CA0B0;--shiki-dark-font-style:italic">// ... later ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">    var</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> prog_node </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> main_progress_node</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">start</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"Configure"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#FAB387;--shiki-dark:#FE640B"> 0</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">    defer</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> prog_node</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">end</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">()</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">    try</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> builder</span><span style="color:#94E2D5;--shiki-dark:#179299">.</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">runBuild</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(root)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span><span style="color:#6C7086;font-style:italic;--shiki-dark:#9CA0B0;--shiki-dark-font-style:italic">  // &#x3C;-- This calls YOUR build() function!</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">    createModuleDependencies</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(builder) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">catch</span><span style="color:#F38BA8;font-style:italic;--shiki-dark:#D20F39;--shiki-dark-font-style:italic"> @panic</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"OOM"</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">)</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CDD6F4;--shiki-dark:#4C4F69">}</span></span></code></pre>
<p>The <code>builder.runBuild(root)</code> line is calling the <code>build()</code> function from YOUR <code>build.zig</code> file (which was imported as <code>@build</code>).</p>
<p>This two-stage process might seem like overhead, but it’s brilliant. The build runner itself benefits from caching, so unless you modify <code>build.zig</code>, subsequent builds skip this step entirely. It’s meta-programming without the usual <em>meta-headaches</em>.
The build system uses a DAG (<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">Directed Acyclic Graph</a>) of steps that run concurrently. Each step can depend on others, and the system is smart enough to skip steps whose inputs haven’t changed. This isn’t revolutionary, <a href="https://www.gnu.org/software/make/manual/make.html">make</a> figured this out decades ago, but Zig implements it correctly.</p>
<h3 id="where-this-happens-in-the-zig-compiler">Where this happens in the Zig compiler</h3>
<p>When you run <code>zig build</code>, the main Zig compiler does something <em>like</em> this:</p>
<ul>
<li>It sees you want to run the build system.</li>
<li>It creates a temporary Zig program that combines:
<ul>
<li>The standard <code>build_runner.zig</code></li>
<li>Your <code>build.zig</code> file (imported as <code>@build</code>)</li>
<li>Your dependencies from <code>build.zig.zon</code> (imported as <code>@dependencies</code>)</li>
</ul>
</li>
<li>It compiles this combined program into an executable (this goes in <code>.zig-cache/o/</code>)</li>
<li>It runs that executable with the appropriate arguments</li>
</ul>
<p>Look at the command-line argument parsing in <code>build_runner.zig</code>:</p>
<pre class="astro-code astro-code-themes catppuccin-mocha catppuccin-latte" style="background-color:#1e1e2e;--shiki-dark-bg:#eff1f5;color:#cdd6f4;--shiki-dark:#4c4f69; overflow-x: auto;" tabindex="0" data-language="zig"><code><span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> zig_exe </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> nextArg</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(args</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">arg_idx) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">orelse</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> fatal</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"missing zig compiler path"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> .</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{})</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> zig_lib_dir </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> nextArg</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(args</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">arg_idx) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">orelse</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> fatal</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"missing zig lib directory path"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> .</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{})</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> build_root </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> nextArg</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(args</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">arg_idx) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">orelse</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> fatal</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"missing build root directory path"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> .</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{})</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> cache_root </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> nextArg</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(args</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">arg_idx) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">orelse</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> fatal</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"missing cache root directory path"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> .</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{})</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span>
<span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">const</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> global_cache_root </span><span style="color:#94E2D5;--shiki-dark:#179299">=</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> nextArg</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(args</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> &#x26;</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">arg_idx) </span><span style="color:#CBA6F7;--shiki-dark:#8839EF">orelse</span><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic"> fatal</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">(</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">"missing global cache root directory path"</span><span style="color:#9399B2;--shiki-dark:#7C7F93">,</span><span style="color:#94E2D5;--shiki-dark:#179299"> .</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69">{})</span><span style="color:#9399B2;--shiki-dark:#7C7F93">;</span></span></code></pre>
<p>These arguments are passed <strong>BY</strong> the Zig compiler <strong>TO</strong> the build runner executable. The Zig compiler launches the build runner with these paths.</p>
<p>Check by yourself:</p>
<ul>
<li>Run <code>zig build</code> in a project</li>
<li>Look in <code>.zig-cache/o/*/build</code> (or <code>build.exe</code> on Windows)</li>
<li>That’s the compiled build runner!</li>
<li>You can even run it directly (though it needs the right arguments -.-)</li>
</ul>
<h2 id="hash-everything-trust-nothing">Hash Everything, Trust Nothing</h2>
<p>The caching system’s paranoia level would make a conspiracy theorist blush. When determining if a cached artifact is valid, Zig doesn’t just check if source files have changed. It verifies:</p>
<ul>
<li>Source file contents (via SHA-256)</li>
<li>Compiler flags and options</li>
<li>Target architecture and ABI</li>
<li>Dependencies (both explicit and implicit)</li>
<li>Build configuration options (even environment variables that might affect the build)</li>
</ul>
<p>This thoroughness means you can’t accidentally use a debug build when you wanted release, or mix up architectures when cross-compiling. The cache key includes everything that matters, which is refreshingly different from systems that think “clean builds” are a regular part of the development process.</p>
<h2 id="incremental-compilation">Incremental compilation</h2>
<p>While the current caching system is already impressive, Zig’s working toward something even better: <strong>true incremental compilation</strong> at the declaration level. Instead of recompiling entire <a href="https://en.wikipedia.org/wiki/Translation_unit_(programming)">translation units</a> when you change a single function, the self-hosted compiler can <strong>patch binaries in-place</strong>.
This works by structuring the output binary as loosely coupled blocks, one per top-level declaration. Change a function? Only that block gets recompiled and patched into the existing binary.
The <a href="https://ziglang.org/download/0.14.0/release-notes.html#Incremental-Compilation">incremental compilation</a> maintains its own dependency graph at the AST level, tracking which declarations depend on which. This fine-grained tracking means changing a comment doesn’t trigger a rebuild of dependent code (because why would it?).</p>
<blockquote>
<p>Hey! It’s not available for <a href="https://github.com/ziglang/zig/blob/b8ac740a1b072168c24785cf8d1c8315ed6db8b0/src/link/Elf.zig#L404">every Linker backend</a>, I know, I know! Don’t spam my socials with such nitpicking.</p>
</blockquote>
<h2 id="cross-compilation">Cross-Compilation</h2>
<p>Here’s where Zig’s caching really shines. When you cross-compile, say from Windows to Linux, Zig can build musl libc from source and cache it. The next time you target the same platform, that cached libc is instantly available. No hunting for toolchains, no version mismatches, no “works on my machine” excuses.
The entire cross-compilation toolchain (<code>libc</code> headers, <code>compiler-rt</code>, <code>libunwind</code>) is cached (globally) after first use. This is how Zig manages to ship support for 40+ target platforms in a <code>30MB</code> download while LLVM’s Windows build alone is <code>132MB</code>.</p>
<h2 id="performance">Performance</h2>
<p>The proof is in the pudding, or in this case, the build times. A no-change rebuild with Zig typically completes in milliseconds, not seconds.</p>
<pre class="astro-code astro-code-themes catppuccin-mocha catppuccin-latte" style="background-color:#1e1e2e;--shiki-dark-bg:#eff1f5;color:#cdd6f4;--shiki-dark:#4c4f69; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#CBA6F7;--shiki-dark:#8839EF">time</span><span style="color:#CDD6F4;--shiki-dark:#4C4F69"> zig build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">________________________________________________________</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">Executed</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> in</span><span style="color:#FAB387;--shiki-dark:#FE640B">   68.97</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">    fish</span><span style="color:#A6E3A1;--shiki-dark:#40A02B">           external</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">   usr</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> time</span><span style="color:#FAB387;--shiki-dark:#FE640B">   33.11</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span><span style="color:#FAB387;--shiki-dark:#FE640B">    1.11</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span><span style="color:#FAB387;--shiki-dark:#FE640B">   32.00</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic;--shiki-dark:#1E66F5;--shiki-dark-font-style:italic">   sys</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> time</span><span style="color:#FAB387;--shiki-dark:#FE640B">   54.77</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span><span style="color:#FAB387;--shiki-dark:#FE640B">    0.06</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span><span style="color:#FAB387;--shiki-dark:#FE640B">   54.71</span><span style="color:#A6E3A1;--shiki-dark:#40A02B"> millis</span></span></code></pre>
<p>The build system can determine that nothing needs to be done without spawning a dozen processes or parsing makefiles written in a language that makes Perl look readable.
When you do change something, only the affected parts rebuild. The caching system’s overhead is negligible because it’s not doing stupid things like serializing dependency graphs to XML or maintaining a SQLite database of build artifacts (yes, some build systems do this).</p>
<h2 id="global-cache">Global cache</h2>
<p>Zig also supports a global cache directory (typically in <code>~/.cache/zig/</code>), separate from project-local caches. This means everyday operations, such as formatting code, don’t litter your file system with cache directories. It’s a slight touch, but it shows someone thought about the user experience beyond “it compiles, ship it.”</p>
<h2 id="the-bottom-line">The bottom line</h2>
<p>Zig’s build cache isn’t revolutionary because it introduces new concepts. It’s revolutionary because it implements existing concepts correctly. It’s deterministic, <a href="https://en.wikipedia.org/wiki/Content-addressable_storage">content-addressable</a>, comprehensive, and fast. It doesn’t require periodic “clean builds” to fix mysterious issues. <strong><em>It doesn’t get confused by daylight saving time.</em></strong> It just works.</p>
<p>In an industry where “<em>delete node_modules and try again</em>” is considered debugging, Zig’s approach is refreshingly competent. It’s almost as if someone realized that computers are good at comparing bytes and decided to let them do that instead of trusting timestamps from filesystem APIs that were designed when, here in Brazil, we were living under a <a href="https://www.cafehistoria.com.br/military-dictatorship-in-brazil-a-history/">Corporate-Military dictatorship</a>.</p>
<p>Hear me out: The real tragedy is that this should be normal. Every build system should work this well. The fact that Zig’s approach seems revolutionary says more about the sorry state of build systems than about Zig itself. But credit where it’s due: they’ve shown it’s possible to build a caching system that doesn’t make developers question their career choices.</p>
<p>Now, if you’ll excuse me, I need to delete some <code>target/</code> directories and pretend that’s a normal part of software development.</p>  </main> <button id="back-to-top-btn" aria-label="back to top" class="z-50" data-astro-cid-xuhzuiaq> <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false" data-astro-cid-xuhzuiaq="true" class="w-7 h-7 sm:w-5 s:h-6" astro-icon="carbon:arrow-up"><path fill="currentColor" d="M16 4 6 14l1.41 1.41L15 7.83V28h2V7.83l7.59 7.58L26 14 16 4z"/></svg> </button>  <script type="module">const e=document.getElementById("back-to-top-btn");e&&(e.addEventListener("click",()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0}),window.addEventListener("scroll",()=>{window.scrollY<document.documentElement.clientHeight?(e.classList.remove("fade-in"),e.classList.add("fade-out"),e.style.display="flex"):(e.classList.remove("fade-out"),e.classList.add("fade-in"))}));</script> </article>   <aside class="hidden sm:block"> <div class="flex flex-col space-y-2"> <h2 class="font-semibold text-lg text-textColor">Alex Rios</h2> <p>alexrios.me</p> <div class="flex flex-wrap items-end gap-x-4"> <ul class="flex flex-wrap flex-1 items-center gap-x-2 sm:flex-initial"> <li class="flex"> <a class="inline-block p-1 sm:hover:text-accent hover:animate-spin" href="https://github.com/alexrios" target="_blank" rel="noopener noreferrer" title="Github"> <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" class="h-5 w-5" astro-icon="mdi:github"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg> <span class="sr-only">Github</span> </a> </li><li class="flex"> <a class="inline-block p-1 sm:hover:text-accent hover:animate-spin" href="https://linkedin.com/in/the-alex-rios" target="_blank" rel="noopener noreferrer" title="LinkedIn"> <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" class="h-5 w-5" astro-icon="mdi:linkedin"><path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg> <span class="sr-only">LinkedIn</span> </a> </li><li class="flex"> <a class="inline-block p-1 sm:hover:text-accent hover:animate-spin" href="https://x.com/alextrending" target="_blank" rel="noopener noreferrer" title="twitter"> <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" class="h-5 w-5" astro-icon="mdi:twitter"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg> <span class="sr-only">twitter</span> </a> </li><li class="flex"> <a class="inline-block p-1 sm:hover:text-accent hover:animate-spin" href="/rss.xml" target="_blank" rel="noopener noreferrer" title="rss"> <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" class="h-5 w-5" astro-icon="mdi:rss"><path fill="currentColor" d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20 5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg> <span class="sr-only">rss</span> </a> </li> </ul> </div> <span class="!my-4 text-accent" aria-hidden>---</span>
                    <p> A masterclass in not doing stupid things again and again... </p>   </div> <nav class="sticky top-20 order-2 hidden basis-64 lg:block"> <hr> <h2 class="font-bold text-lg">Table of Contents</h2> <ul class="-me-32" id="toc"> <li data-astro-cid-zekvapgs> <a href="#determinism-isnt-optional" id="toc-determinism-isnt-optional" data-astro-cid-zekvapgs> Determinism isn’t optional </a>  </li> <li data-astro-cid-zekvapgs> <a href="#the-build-process" id="toc-the-build-process" data-astro-cid-zekvapgs> The Build Process </a> <ul class="ml-2" data-astro-cid-zekvapgs> <li data-astro-cid-zekvapgs> <a href="#stage-1-build-runner-compilation" id="toc-stage-1-build-runner-compilation" data-astro-cid-zekvapgs> Stage 1: Build runner compilation </a>  </li> <li data-astro-cid-zekvapgs> <a href="#stage-2-running-your-build" id="toc-stage-2-running-your-build" data-astro-cid-zekvapgs> Stage 2: Running your build </a>  </li> <li data-astro-cid-zekvapgs> <a href="#where-this-happens-in-the-zig-compiler" id="toc-where-this-happens-in-the-zig-compiler" data-astro-cid-zekvapgs> Where this happens in the Zig compiler </a>  </li>  </ul> </li> <li data-astro-cid-zekvapgs> <a href="#hash-everything-trust-nothing" id="toc-hash-everything-trust-nothing" data-astro-cid-zekvapgs> Hash Everything, Trust Nothing </a>  </li> <li data-astro-cid-zekvapgs> <a href="#incremental-compilation" id="toc-incremental-compilation" data-astro-cid-zekvapgs> Incremental compilation </a>  </li> <li data-astro-cid-zekvapgs> <a href="#cross-compilation" id="toc-cross-compilation" data-astro-cid-zekvapgs> Cross-Compilation </a>  </li> <li data-astro-cid-zekvapgs> <a href="#performance" id="toc-performance" data-astro-cid-zekvapgs> Performance </a>  </li> <li data-astro-cid-zekvapgs> <a href="#global-cache" id="toc-global-cache" data-astro-cid-zekvapgs> Global cache </a>  </li> <li data-astro-cid-zekvapgs> <a href="#the-bottom-line" id="toc-the-bottom-line" data-astro-cid-zekvapgs> The bottom line </a>  </li>  </ul> </nav> <script type="module">const c=document.getElementById("toc");c&&c?.addEventListener("click",t=>{const n=window.location.hash.slice(1),e=document.getElementById(`toc-${n}`);e instanceof HTMLElement&&e?.classList.remove("active-toc"),t.target instanceof HTMLElement&&t.target.classList.add("active-toc")});</script> </aside> </main> <footer class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold sm:flex-row sm:justify-between sm:text-xs text-textColor mb-8"> <div class="mr-2 sm:mr-0">
Copyright &copy; 2025  Alex Rios </div> <nav aria-label="More on this site" class="gap-x-0 sm:gap-x-2 sm:flex sm:divide-x sm:divide-accent"> <a href="/" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> Home </a><a href="/about" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> About </a><a href="/blog" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> Blog </a><a href="/books" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> Books </a><a href="/speaker" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> Speaker </a><a href="/archive" class="px-2 py-0 hover:text-textColor hover:underline sm:px-4 sm:py-2"> Archive </a> </nav> </footer> </body></html> <script type="module">const n='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19V1h9l6 6v12zm8-11h5l-5-5zM2 23V7h2v14h11v2z"/></svg>',i=Array.from(document.querySelectorAll("pre.astro-code"));for(const t of i){let o=t.parentElement;if(o){let c=document.createElement("div");o.replaceChild(c,t),c.classList.add("relative"),c.appendChild(t);const e=document.createElement("button");e.className="cody-copy-code",e.innerHTML=n,e.title="Copy code block",t.setAttribute("tabindex","0"),c.appendChild(e),e.addEventListener("click",async()=>{await r(t,e)})}}async function r(t,o){const e=t.querySelector("code")?.innerText??"";await navigator.clipboard.writeText(e),o.innerText="Code Copied",setTimeout(()=>{o.innerHTML=n},700)}</script>